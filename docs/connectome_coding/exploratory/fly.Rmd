---
title: "Fly Connectome Exploration"
author: "Eric Bridgeford"
date: "May 17, 2018"
output: html_document
---

```{r, message=FALSE}
require(igraph)
require(graphstats)
require(gridExtra)
require(ggplot2)
```

```{r}
# define this function
load.data <- function(dat)
{
  e <- new.env()
  name <- data(list=dat, envir = e)[1]
  e[[name[[1]]]]
}
make_plots <- function(datname, title, vertex.name, attr.code, attr.name, wt) {
  # Adjacency Matrix
  g <- load.data(datname)
  adj.plot <- gs.plot.plot_adjacency(g, title=title, edge.attr = wt, xlabel=vertex.name, ylabel=vertex.name)
  
  # Degree Sequence
  gr.degseq <- degree(g)
  gr.deg.dat <- data.frame(vertex=names(V(g)), degree=gr.degseq)
  deg.plot <- ggplot(gr.deg.dat, aes(x=degree)) +
    geom_density() +
    xlab("Vertex Degree") +
    ylab("Probability") +
    ggtitle(title) +
    theme_bw()
  
  # SBM
  gr.sbm <- gs.sbm.fit(g, community.attribute=attr.code)
  sbm.plot <- gs.plot.plot_adjacency(gr.sbm, title=title, xlabel=attr.name, vertex.label=TRUE, ylabel=attr.name, edge.attr="weight")
  return(list(adj.plot=adj.plot, deg.plot=deg.plot, sbm.plot=sbm.plot))
}
```

# Fly, Left Hemisphere

```{r}
fly.left <- make_plots("fly.left", "Fly, Left Hemisphere", "Neuron", "type", "Neuron Type", NULL)
```

# Fly, Right Hemisphere

```{r}
fly.right <- make_plots("fly.right", "Fly, Right Hemisphere", "Neuron", "type", "Neuron Type", NULL)
```

# Comparison

## Adjacency Matrix

```{r, fig.width=12, fig.height=5}
grid.arrange(fly.left$adj.plot, fly.right$adj.plot, ncol=2)
```

## Degree Sequence

```{r, fig.width=12, fig.height=5}
grid.arrange(fly.left$deg.plot, fly.right$deg.plot, ncol=2)
```

## SBM

```{r, fig.width=12, fig.height=5}
grid.arrange(fly.left$sbm.plot, fly.right$sbm.plot, ncol=2)
```
