<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Ronak Mehta" />

<meta name="date" content="2018-05-14" />

<title>Model-Based Clustering</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Model-Based Clustering</h1>
<h4 class="author"><em>Ronak Mehta</em></h4>
<h4 class="date"><em>2018-05-14</em></h4>



<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(graphstats)
<span class="kw">require</span>(mclust)
<span class="kw">require</span>(MASS)
<span class="kw">require</span>(ggplot2)</code></pre></div>
<p>Here, we use the <code>gclust</code> function to select the optimal number of clusters for a Gaussian Mixture Model. This function uses the Bayesian Information Criterion (BIC) for data-based model selection.</p>
<div id="a-mixture-of-2-normal-densities" class="section level2">
<h2>A Mixture of 2 Normal Densities</h2>
<p>We generate a mixture of 2 Gaussian densities, and try to estimate the number of components from simulated data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Mixture parameters</span>
mu0 &lt;-<span class="st"> </span>-<span class="fl">1.5</span>
mu1 &lt;-<span class="st"> </span><span class="dv">2</span>
sigma0 &lt;-<span class="st"> </span><span class="dv">1</span>
sigma1 &lt;-<span class="st"> </span><span class="fl">0.5</span>
pi0 &lt;-<span class="st"> </span><span class="fl">0.5</span>
pi1 &lt;-<span class="st"> </span><span class="dv">1</span> -<span class="st"> </span>pi0

<span class="co"># Defined separate and mixed PDFs as functions.</span>
mixture_pdf &lt;-<span class="st"> </span>function(x) { pi0*<span class="kw">dnorm</span>(x, mu0, sigma0) +<span class="st"> </span>pi1*<span class="kw">dnorm</span>(x, mu1, sigma1) }
norm0_pdf &lt;-<span class="st"> </span>function(x) { pi0*<span class="kw">dnorm</span>(x, mu0, sigma0) }
norm1_pdf &lt;-<span class="st"> </span>function(x) { pi1*<span class="kw">dnorm</span>(x, mu1, sigma1) }

<span class="co"># Display.</span>
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(<span class="dt">x =</span> <span class="kw">c</span>(-<span class="dv">4</span>, <span class="dv">4</span>)), <span class="kw">aes</span>(<span class="dt">x =</span> x)) +
<span class="st">        </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> mixture_pdf, <span class="dt">size =</span> <span class="fl">1.5</span>) +
<span class="st">        </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> norm0_pdf, <span class="dt">colour =</span> <span class="st">&quot;deeppink&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>) +
<span class="st">        </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> norm1_pdf, <span class="dt">colour =</span> <span class="st">&quot;dodgerblue3&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>)
p +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;X&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;PDF&quot;</span>) +<span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Mixture of Two Gaussian Densities&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Given sufficient data, we expect <code>gclust</code> to return 2 as the optimal number of components, when considering component numbers from 1 to 5.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Condition on class sizes of pi0*n and pi1*n to sample data matrix X.</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
n &lt;-<span class="st"> </span><span class="dv">100</span>
X0 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(pi0*n, mu0, sigma0)
X1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(pi1*n, mu1, sigma1)
X &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">c</span>(X0, X1), <span class="dt">nrow =</span> n)

<span class="co"># Run gclust, which will consider models from K = 1 to 5.</span>
G &lt;-<span class="st"> </span><span class="kw">gclust</span>(X, <span class="dt">K =</span> <span class="dv">5</span>)
<span class="kw">cat</span>(<span class="st">&quot;The BIC-optimal number of components for the data is:&quot;</span>, G, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</code></pre></div>
<pre><code>## The BIC-optimal number of components for the data is: 2</code></pre>
<p>The selected number of components can then be used as a parameter for a clustering algorithm such as EM.</p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
