<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Ronak Mehta" />

<meta name="date" content="2018-05-14" />

<title>Laplacian Spectral Embedding</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Laplacian Spectral Embedding</h1>
<h4 class="author"><em>Ronak Mehta</em></h4>
<h4 class="date"><em>2018-05-14</em></h4>



<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(graphstats)
<span class="kw">require</span>(mclust)
<span class="kw">require</span>(ggplot2)</code></pre></div>
<p>Here, we present the <code>lse</code> function, used for representing graphs in lower-dimensions.</p>
<div id="stochastic-blockmodel-via-random-dot-product-graph" class="section level2">
<h2>Stochastic Blockmodel via Random Dot-Product Graph</h2>
<p>We will apply LSE to a core-periphery SBM constructed from an RDPG. We start with latent vectors [0.85, 0] and [0.3, 0.4]. These make edge probability within block 1 approximately 0.75 (the core), and other edge probabilities approximately 0.25. The Adjacency Matrix is plotted below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create latent vectors, and edge probability matrix.</span>
block1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">c</span>(<span class="fl">0.85</span>, <span class="dv">0</span>), <span class="dt">nrow =</span> <span class="dv">2</span>)
block2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">c</span>(<span class="fl">0.3</span>, <span class="fl">0.4</span>), <span class="dt">nrow =</span> <span class="dv">2</span>)
block_probs &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="kw">t</span>(block1) %*%<span class="st"> </span>block1,
                        <span class="kw">t</span>(block1) %*%<span class="st"> </span>block2,
                        <span class="kw">t</span>(block2) %*%<span class="st"> </span>block1,
                        <span class="kw">t</span>(block2) %*%<span class="st"> </span>block2), <span class="dt">ncol =</span> <span class="dv">2</span>)

<span class="co"># Create SBM. Use higher edge probability if nodes are from same block.</span>
<span class="kw">set.seed</span>(<span class="dv">456</span>)
n &lt;-<span class="st"> </span><span class="dv">100</span>
block.sizes &lt;-<span class="st"> </span><span class="kw">c</span>(n/<span class="dv">2</span>, n/<span class="dv">2</span>)
blocks &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), block.sizes)
g &lt;-<span class="st"> </span>igraph::<span class="kw">sample_sbm</span>(n, block_probs, block.sizes)
<span class="kw">gs.plot.plot_matrix</span>(igraph::<span class="kw">as_adjacency_matrix</span>(g, <span class="dt">sparse =</span> <span class="ot">FALSE</span>),
                    <span class="dt">legend.name=</span><span class="st">&quot;Connection&quot;</span>,
                    <span class="dt">ffactor =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="embedding-the-graph" class="section level2">
<h2>Embedding the Graph</h2>
<p>Now, we call the function to embed the Laplacian matrix in R^2. Returned is an nx2 matrix. By plotting the data, we observe that the core-periphery structure translates well to Euclidean space.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Embed graph into R^2.</span>
dim &lt;-<span class="st"> </span><span class="dv">2</span>
X &lt;-<span class="st"> </span><span class="kw">lse</span>(g, dim)
dat &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(X)

<span class="co"># Display.</span>
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dat) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> V1, <span class="dt">y =</span> V2), <span class="dt">color=</span>blocks)
p +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;PC Score 1&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;PC Score 2&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
